<div class="header">
  <span class="user-name" (click)="handleUsernameClick()">{{
    tokenService.tokenNameSurname()
    }}</span>
  <div class="search-bar">
    <div class="search-input">
      <input matInput #searchInput placeholder="Listeyi arayın" />
      <button mat-icon-button (click)="filterByName(searchInput.value)">
        <mat-icon>search</mat-icon>
      </button>
    </div>
  </div>

  <div class="user-info">
    <button (click)="addPerson()" class="add-person-button">
      <i class="material-icons">person_add</i>{{ "addPeople" | transloco }}
    </button>
    <button>
      <i class="material-icons">share</i>{{ "share" | transloco }}
    </button>
    <button>
      <i class="material-icons">event</i>{{ "unplanned" | transloco }}
    </button>
    <button [matMenuTriggerFor]="filterMenu" *ngIf="activeFilters.length == 0">
      <i class="material-icons">filter_list</i>{{ "filter" | transloco }}
    </button>
    <button [matMenuTriggerFor]="filterMenu" *ngIf="activeFilters.length != 0">
      <i class="material-icons">filter_list</i>{{ activeFilters.length }} filtre
      applied
    </button>
    <button>
      <i class="material-icons">more_horiz</i>{{ "more" | transloco }}
    </button>
  </div>
</div>
<mat-menu #filterMenu="matMenu" [class]="customMenuClass">
  <div>NEDEN</div>
  <div>BÖYLE</div>
  <div>mfkgelrgm</div>
  <button class="custom-menu-item" mat-menu-item [class.active]="activeFilters.includes('AssignedToMe')"
    (click)="applyFilter('AssignedToMe')">
    <mat-icon>account_circle</mat-icon> Assigned To Me
    <mat-icon *ngIf="activeFilters.includes('AssignedToMe')" class="selected-icon">check_circle
    </mat-icon>
  </button>
  

  <button class="custom-menu-item" mat-menu-item [class.active]="activeFilters.includes('DueDateThisWeek')"
    (click)="applyFilter('DueDateThisWeek')">
    Due date this week <mat-icon>notification_important</mat-icon>
    <mat-icon *ngIf="activeFilters.includes('DueDateThisWeek')" class="selected-icon">check_circle</mat-icon>
  </button>

  <button class="custom-menu-item" mat-menu-item (click)="applyFilter('CompletedTasks')">
    <mat-icon>check_circle_outline</mat-icon>Completed Tasks
  </button>
  <button class="custom-menu-item" mat-menu-item (click)="applyFilter('BetweenDates')">
    <mat-icon>alarm</mat-icon>Between these dates
  </button>
  <div class="date-input-container">
    <mat-form-field class="mat-form-field">
      <input matInput [matDatepicker]="fromDatePicker" placeholder="From Date" [(ngModel)]="fromDate" />
      <mat-datepicker-toggle class="mat-datepicker-toggle" matSuffix [for]="fromDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #fromDatePicker></mat-datepicker>
    </mat-form-field>
    <mat-icon class="custom-icon">arrow_forward</mat-icon>
    <mat-form-field>
      <input matInput [matDatepicker]="toDatePicker" placeholder="To Date" [(ngModel)]="toDate" />
      <mat-datepicker-toggle matSuffix [for]="toDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #toDatePicker></mat-datepicker>
    </mat-form-field>
  </div>

  <button class="custom-menu-item" mat-menu-item (click)="applyFilter('AssignedTo')">Assigned To</button>
  <!-- Kişiler gelecek çoook kişi var ise üç nokta -->

  <button class="custom-menu-item" *ngIf="selectedColumns.length == 0" mat-menu-item (click)="applyFilter('Columns')">
    Columns
  </button>
  <button class="custom-menu-item" *ngIf="selectedColumns.length != 0" mat-menu-item (click)="applyFilter('Columns')">
    Columns {{ selectedColumns.length }}
  </button>
  <div class="column-filter">
    <!-- <div class="column-checkbox" *ngFor="let column of projectColumns">
          <mat-checkbox [(ngModel)]="selectedColumns[column.id]" (change)="applyFilter('Columns')">{{ column.name }}</mat-checkbox>
        </div> -->
  </div>

  <button class="custom-menu-item" mat-menu-item (click)="applyFilter('UpdatedDate')">
    <mat-icon>alarm</mat-icon>Update Date Range
  </button>
  <div class="date-input-container">
    <mat-form-field>
      <input matInput [matDatepicker]="updatedFromDatePicker" placeholder="From Date" [(ngModel)]="updatedFromDate" />
      <mat-datepicker-toggle matSuffix [for]="updatedFromDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #updatedFromDatePicker></mat-datepicker>
    </mat-form-field>
    <mat-icon class="custom-icon">arrow_forward</mat-icon>
    <mat-form-field>
      <input matInput [matDatepicker]="updatedToDatePicker" placeholder="To Date" [(ngModel)]="updatedToDate" />
      <mat-datepicker-toggle matSuffix [for]="updatedToDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #updatedToDatePicker></mat-datepicker>
    </mat-form-field>
  </div>

  <button class="custom-menu-item" mat-menu-item (click)="applyFilter('CreatedDate')">
    <mat-icon>alarm</mat-icon>Creation Date Range
  </button>
  <div class="date-input-container">
    <mat-form-field>
      <input matInput [matDatepicker]="createdFromDatePicker" placeholder="From Date" [(ngModel)]="createdFromDate" />
      <mat-datepicker-toggle matSuffix [for]="createdFromDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #createdFromDatePicker></mat-datepicker>
    </mat-form-field>
    <mat-icon class="custom-icon">arrow_forward</mat-icon>
    <mat-form-field>
      <input matInput [matDatepicker]="createdToDatePicker" placeholder="To Date" [(ngModel)]="createdToDate" />
      <mat-datepicker-toggle matSuffix [for]="createdToDatePicker"></mat-datepicker-toggle>
      <mat-datepicker #createdToDatePicker></mat-datepicker>
    </mat-form-field>
  </div>

  <button class="custom-menu-item" mat-menu-item (click)="applyFilter('Reporter')">Reporter</button>

  <button mat-menu-item (click)="applyFilter('Priorities')"><mat-icon>priority_high</mat-icon> Priorities {{selectedPriorities.length}}
  </button>
  <div class="priority-images">
    <img (click)="handlePriorityClick(1)" [class.selected]="selectedPriorities.includes(1)" src="../../assets/lowest.png" alt="Easy" />
    <img (click)="handlePriorityClick(2)" [class.selected]="selectedPriorities.includes(2)" src="../../assets/low.png" alt="Medium" />
    <img (click)="handlePriorityClick(3)" [class.selected]="selectedPriorities.includes(3)" src="../../assets/medium.png" alt="Normal" />
    <img (click)="handlePriorityClick(4)" [class.selected]="selectedPriorities.includes(4)" src="../../assets/high.png" alt="Difficult" />
    <img (click)="handlePriorityClick(5)" [class.selected]="selectedPriorities.includes(5)" src="../../assets/highest.png" alt="Difficult" />
  </div>
  

</mat-menu>

<div class="outer-container">
  <div class="overflow-table-container">
    <table mat-table [dataSource]="filteredData">
      <!-- <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef>
                    <mat-icon>label</mat-icon> {{'id' | transloco}}
                </th>
                <td mat-cell *matCellDef="let ListTask ">{{ ListTask.id }}</td>
            </ng-container> -->

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>text_fields</mat-icon> Task {{ "name" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">{{ ListTask.name }}</td>
      </ng-container>

      <ng-container matColumnDef="columnId">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>view_column</mat-icon> {{ "column" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">{{ ListTask.columnId }}</td>
      </ng-container>

      <ng-container matColumnDef="assigneeId">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>person</mat-icon> {{ "assignee" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">{{ ListTask.assigneeId }}</td>
      </ng-container>

      <ng-container matColumnDef="reporterId">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>report</mat-icon> {{ "reporter" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">{{ ListTask.reporterId }}</td>
      </ng-container>

      <ng-container matColumnDef="DueDate">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>calendar_today</mat-icon> {{ "dueDate" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">
          {{ ListTask.dueDate | date : "dd/MM/yy" }}
        </td>
      </ng-container>

      <!-- <ng-container matColumnDef="Priority">
                <th mat-header-cell *matHeaderCellDef>
                    <mat-icon>priority_high</mat-icon> {{'priority' | transloco}}
                </th>
                <td mat-cell *matCellDef="let ListTask">{{ priorityService.getIcon(ListTask.priority) }}</td>
            </ng-container> -->
      <ng-container matColumnDef="Priority">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>priority_high</mat-icon> {{ "priority" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">
          <img [src]="priorityService.getIcon(ListTask.priority)" alt="Priority Icon" class="priority-icon" />
        </td>
      </ng-container>

      <ng-container matColumnDef="UpdateDate">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>update</mat-icon> {{ "updateDate" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">
          {{ ListTask.updatedDate | date : "dd/MM/yy" }}
        </td>
      </ng-container>

      <ng-container matColumnDef="CreateDate">
        <th mat-header-cell *matHeaderCellDef>
          <mat-icon>create</mat-icon> {{ "createdDate" | transloco }}
        </th>
        <td mat-cell *matCellDef="let ListTask">
          {{ ListTask.createdDate | date : "dd/MM/yy" }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="[
          'name',
          'columnId',
          'assigneeId',
          'reporterId',
          'DueDate',
          'Priority',
          'UpdateDate',
          'CreateDate'
        ]"></tr>
      <tr mat-row *matRowDef="
          let row;
          columns: [
            'name',
            'columnId',
            'assigneeId',
            'reporterId',
            'DueDate',
            'Priority',
            'UpdateDate',
            'CreateDate'
          ]
        "></tr>
    </table>
  </div>
</div>

<div class="add-button-container">
  <button mat-raised-button color="primary" (click)="addPerson()">
    Oluştur
  </button>
</div>